import{D as s}from"./docs-LJADo47n.js";class m{constructor(){Array.from(document.querySelectorAll("[data-optional-block]")).forEach((e,o)=>{new c(e,o)}),s.onDynamicContent(document.documentElement,"[data-optional-block]",e=>{e.forEach((o,i)=>{new c(o,i+Date.now())})}),Array.from(document.querySelectorAll("[data-optional-required]")).forEach((e,o)=>{new h(e,o)}),s.onDynamicContent(document.documentElement,"[data-optional-required]",e=>{e.forEach((o,i)=>{new h(o,i+Date.now())})})}}class c{constructor(r,t){this.formElements=[],this.clearAllOnHide=!1,this.element=r;try{this.controllerValue=JSON.parse(r.getAttribute("data-optional-block"))}catch(e){console.warn(`Error parsing JSON for data-optional-block: ${e}`)}this.clearAllOnHide=!!r.getAttribute("data-clear-all-on-hide"),this.controllerValue&&typeof this.controllerValue=="object"&&!Array.isArray(this.controllerValue)&&Object.keys(this.controllerValue).forEach(e=>{this.formElements.push(...Array.from(document.querySelectorAll(`[name="${e}"]`)))}),this.changeListener=this.changeAction.bind(this),Array.from(this.formElements).forEach(e=>{e.addEventListener("change",this.changeListener)}),this.toggle(new Event("init")),this.disableAllFormElements()}toggle(r){if(n.check(this.formElements,this.controllerValue))this.element.setAttribute("open","");else{this.element.removeAttribute("open");let t=[];this.clearAllOnHide?t=Array.from(this.element.querySelectorAll("input, textarea, select")):t=Array.from(this.element.querySelectorAll("[data-clear-on-hide]")),t.forEach(e=>{e.nodeName==="INPUT"&&(e.getAttribute("type").toLowerCase()==="checkbox"||e.getAttribute("type").toLowerCase()==="radio"?e.checked=!1:e.value="")})}this.disableAllFormElements()}disableAllFormElements(){const r=this.element.querySelectorAll("input, textarea, select");Array.from(r).forEach(t=>{this.element.hasAttribute("open")?(t.hasAttribute("data-has-required")&&(t.setAttribute("required","required"),t.removeAttribute("data-has-required")),t.removeAttribute("disabled")):(t.hasAttribute("required")&&(t.removeAttribute("required"),t.setAttribute("data-has-required","true")),t.setAttribute("disabled","disabled"))})}changeAction(r){r.stopPropagation(),this.toggle(r)}}class h{constructor(r,t){this.formElements=[],this.element=r;try{this.controllerValue=JSON.parse(r.getAttribute("data-optional-required"))}catch(e){console.warn(`Error parsing JSON for data-optional-block: ${e}`)}this.controllerValue&&typeof this.controllerValue=="object"&&!Array.isArray(this.controllerValue)&&Object.keys(this.controllerValue).forEach(e=>{this.formElements.push(...Array.from(document.querySelectorAll(`[name="${e}"]`)))}),this.changeListener=this.changeAction.bind(this),Array.from(this.formElements).forEach(e=>{e.addEventListener("change",this.changeListener)})}changeAction(r){r.stopPropagation(),console.log(n.check(this.formElements,this.controllerValue)),n.check(this.formElements,this.controllerValue)?this.element.setAttribute("required",""):this.element.removeAttribute("required")}}class n{constructor(){}static check(r,t){let e=!1;return r.forEach(o=>{const i=o.getAttribute("name");let a=parseInt(o.value)?parseInt(o.value):o.value;if(t[i]!==void 0)e||(o.type.toLowerCase()==="checkbox"||o.type.toLowerCase()==="radio"?(typeof t[i]=="object"?t[i].indexOf(a)>=0&&o.checked&&(e=!0):t[i]===a&&o.checked&&(e=!0),t[i]==0&&!o.checked&&(e=!0)):typeof t[i]=="object"?e=t[i].indexOf(a)>=0:e=t[i]===a);else{console.warn(`No controller value found for input name "${i}" in optional block.`);return}}),e}}export{m as default};
