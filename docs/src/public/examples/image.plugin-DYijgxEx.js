import{A as d}from"./array.prototypes-Bj-0q804.js";d.activateFrom();class m{constructor(o){this.triggerSelector="",this.options={},this.cssClasses={imageStyle:"modal__image w-full max-h-[calc(100vh-6rem)] max-w-[calc(100vw-6rem)]",imageCaptionStyle:"modal__caption p-2 bg-black/50 absolute left-0 right-0 bottom-0 text-sm text-white"},this.triggerSelector=o}getPluginName(){return"image"}getTriggerSelector(){return this.triggerSelector}getOptions(){return this.options}openModalClick(o){this.modalComponent=o;const t=this.modalComponent.trigger,i=(t&&t.getAttribute("data-modal-image"))??this.modalComponent.options.src,e=(t&&t.getAttribute("data-caption"))??this.modalComponent.options.caption??"",a=(t&&t.getAttribute("data-group"))??this.modalComponent.options.group;if(t&&Object.keys(this.modalComponent.trigger.dataset).forEach(n=>{this.cssClasses[n]&&(this.cssClasses[n]=this.modalComponent.trigger.dataset[n])}),a){const s=document.querySelector(`dialog#${a}`);s&&(this.modalComponent.dialog=s,this.changeGroupIndex())}this.modalComponent.dialog||(this.modalComponent.dialog=document.createElement("dialog"),this.modalComponent.dialog.onclose=()=>{this.modalComponent.hideNavigation()},a&&this.modalComponent.dialog.setAttribute("id",a),document.body.appendChild(this.modalComponent.dialog),this.modalComponent.addCloseButton(),this.modalComponent.modalCloseBtn.classList.add("hidden"),this.caption=document.createElement("div"),this.caption.classList.add("hidden"),this.caption.classList.add(...this.cssClasses.imageCaptionStyle.split(" ")),this.caption.innerText=e,this.modalComponent.dialog.appendChild(this.caption)),i?this.openPluginModal(i):console.log("No modal src is provided on the trigger")}gotoNextAction(){this.changeGroupIndex()}gotoPrevAction(){this.changeGroupIndex()}changeGroupIndex(){this.caption.classList.add("hidden"),this.modalLoader.classList.remove("hidden"),this.captionGroup[this.modalComponent.currentGroupIndex]?this.caption.innerText=this.captionGroup[this.modalComponent.currentGroupIndex]:this.caption.innerText="",this.image.setAttribute("src",this.modalComponent.galleryGroup[this.modalComponent.currentGroupIndex])}openPluginModal(o){this.modalComponent.galleryGroup=[],this.captionGroup=[];const t=this.modalComponent.trigger&&this.modalComponent.trigger.getAttribute("data-group");t&&(this.modalComponent.galleryGroup=Array.from(document.querySelectorAll(`[data-group=${t}]`)).map(e=>e.getAttribute("data-modal-image")),document.querySelectorAll(`[data-group=${t}][data-caption]`).length>0&&(this.captionGroup=Array.from(document.querySelectorAll(`[data-group=${t}]`)).map(e=>e.getAttribute("data-caption"))),this.modalComponent.currentGroupIndex=this.modalComponent.galleryGroup.indexOf(o)),this.modalLoader||(this.modalLoader=document.createElement("div"),this.modalLoader.classList.add(...this.modalComponent.cssClasses.loaderStyle.split(" ")),this.modalLoader.insertAdjacentHTML("afterbegin",'<div class="loader"></div>'),this.modalComponent.dialog.insertAdjacentElement("afterbegin",this.modalLoader)),this.image?t&&this.changeGroupIndex():(t&&this.modalComponent.addNavigation(),this.image=document.createElement("img"),this.image.addEventListener("load",i=>{this.modalLoader.classList.add("hidden"),this.modalComponent.modalCloseBtn.classList.remove("hidden"),t&&this.modalComponent.showNavigation(),this.caption.innerText.length>0&&this.caption.classList.remove("hidden")}),this.image.setAttribute("src",o),this.image.classList.add(...this.cssClasses.imageStyle.split(" ")),this.modalComponent.dialog.insertAdjacentElement("afterbegin",this.image)),this.modalComponent.dialog.showModal()}}export{m as ImageModalPlugin};
