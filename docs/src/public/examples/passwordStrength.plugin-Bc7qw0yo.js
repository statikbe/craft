import{F as r}from"./formater-BczQVLTd.js";import{D as m}from"./docs-LJADo47n.js";class y{constructor(t){this.minLength=16,this.maxLength=160,this.cases=!0,this.numbers=!0,this.symbols=!0,this.showStrengthIndicator=!0,this.showStrengthIndicatorText=!0,this.isValid=!1,this.passwordStrengthScore=2,this.cssClasses={strengthIndicatorWrapper:"strength-indicator__wrapper relative h-2 my-1 rounded-sm border border-black/20",strengthIndicator:"strength-indicator w-0 h-full transition-all duration-300 ease-in-out",strengthIndicatorVeryWeak:"bg-red-200",strengthIndicatorWeak:"bg-red-500",strengthIndicatorMedium:"bg-orange-500",strengthIndicatorStrong:"bg-yellow-500",strengthIndicatorVeryStrong:"bg-green-500",strengthIndicatorText:"strength-indicator__text text-xs text-black/50"},this.validationComponent=t}initElement(){const t=document.querySelectorAll("input[data-strength]");Array.from(t).forEach(n=>{this.initPasswordStrength(n)}),m.onDynamicContent(document.documentElement,"input[data-strength]",n=>{n.forEach(a=>{this.initPasswordStrength(a)})})}initPasswordStrength(t){if(this.minLength=t.dataset.minLength?parseInt(t.dataset.minLength,10):this.minLength,this.maxLength=t.dataset.maxLength?parseInt(t.dataset.maxLength,10):this.maxLength,this.cases=t.dataset.cases?t.dataset.cases==="true":this.cases,this.numbers=t.dataset.numbers?t.dataset.numbers==="true":this.numbers,this.symbols=t.dataset.symbols?t.dataset.symbols==="true":this.symbols,this.showStrengthIndicator=t.dataset.showStrengthIndicator?t.dataset.showStrengthIndicator==="true":this.showStrengthIndicator,this.showStrengthIndicatorText=t.dataset.showStrengthIndicatorText?t.dataset.showStrengthIndicatorText==="true":this.showStrengthIndicatorText,Object.keys(t.dataset).forEach(s=>{this.cssClasses[s]&&(this.cssClasses[s]=t.dataset[s])}),this.showStrengthIndicatorText){const s=document.createElement("div");s.classList.add(...this.cssClasses.strengthIndicatorText.split(" ")),s.innerHTML=r.sprintf(this.validationComponent.lang.strength,{min:this.minLength,cases:this.cases?"1":"0",numbers:this.numbers?"1":"0",symbols:this.symbols?"1":"0",max:this.maxLength}),t.parentNode.insertBefore(s,t.nextSibling)}if(this.showStrengthIndicator){this.strengthIndicator=document.createElement("div"),this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicator.split(" "));const s=document.createElement("div");s.classList.add(...this.cssClasses.strengthIndicatorWrapper.split(" ")),s.appendChild(this.strengthIndicator),t.parentNode.insertBefore(s,t.nextSibling),this.passwordStrengthScore+=(this.cases?1:0)+(this.numbers?1:0)+(this.symbols?1:0)}t.addEventListener("invalid",s=>{s.preventDefault(),this.validationComponent.checkValidation(s)});const a=s=>{const e=t.value,o=this.cases?/[A-Z]/.test(e):!0,c=this.numbers?/\d/.test(e):!0,d=this.symbols?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e):!0,l=e.length>=this.minLength,g=e.length<=this.maxLength;if(this.showStrengthIndicator){const i=((e.length>0?1:0)+(o?1:0)+(c?1:0)+(d?1:0)+(l?1:0))/this.passwordStrengthScore*100;this.strengthIndicator.classList.remove(...this.cssClasses.strengthIndicatorVeryWeak.split(" "),...this.cssClasses.strengthIndicatorWeak.split(" "),...this.cssClasses.strengthIndicatorMedium.split(" "),...this.cssClasses.strengthIndicatorStrong.split(" "),...this.cssClasses.strengthIndicatorVeryStrong.split(" ")),this.isValid=!1,g?(this.strengthIndicator.style.width=i+"%",i<=20?this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorVeryWeak.split(" ")):i<=40?this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorWeak.split(" ")):i<=60?this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorMedium.split(" ")):i<=80?this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorStrong.split(" ")):(this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorVeryStrong.split(" ")),this.isValid=!0)):(this.strengthIndicator.style.width="100%",this.strengthIndicator.classList.add(...this.cssClasses.strengthIndicatorWeak.split(" ")))}},h=s=>{this.isValid?(t.setCustomValidity(""),t.reportValidity()):(this.showStrengthIndicatorText?t.setCustomValidity(this.validationComponent.lang.defaultMessage):t.setCustomValidity(r.sprintf(this.validationComponent.lang.strength,{min:this.minLength,cases:this.cases?"1":"0",numbers:this.numbers?"1":"0",symbols:this.symbols?"1":"0",max:this.maxLength})),t.reportValidity())};t.addEventListener("keyup",a),t.addEventListener("change",h)}}export{y as PasswordStrengthPlugin};
