class l{constructor(){const t=document.querySelectorAll("button[data-video-toggle]");Array.from(t).forEach((e,s)=>{new d(e,s)})}}class d{constructor(t,e=0){this.options={url:"",container:null,aspectRatio:"auto",hideTrigger:!0,showCloseButton:!0,hideClass:"hidden",toggleContent:"close"},this.videoOpen=!1,this.openContent="",this.cssClasses={videoToggleContainer:"video-toggle__container relative",videoToggleContent:"video-toggle__content absolute top-0 right-0 bottom-0 left-0",videoToggleIframe:"video-toggle__iframe",videoToggleClose:"video-toggle__close absolute top-0 right-0 p-2 bg-white",videoToggleCloseAfter:'after:block after:shrink-0 after:w-[1em] after:h-[1em] after:mask-center after:mask-no-repeat after:mask-contain after:bg-current after:mask-[url("/icons/clear.svg")]'},this.trigger=t,this.options.url=t.getAttribute("data-video-toggle"),this.options.container=t.hasAttribute("data-video-toggle-container")?document.querySelector(t.getAttribute("data-video-toggle-container")):t.parentElement,this.options.aspectRatio=t.hasAttribute("data-video-toggle-aspect-ratio")?t.getAttribute("data-video-toggle-aspect-ratio"):this.options.aspectRatio,this.options.showCloseButton=t.hasAttribute("data-video-toggle-show-close-button")?t.getAttribute("data-video-toggle-show-close-button")==="true":this.options.showCloseButton,this.options.hideTrigger=t.hasAttribute("data-video-toggle-hide-trigger")?t.getAttribute("data-video-toggle-hide-trigger")==="true":this.options.hideTrigger,this.options.hideClass=t.hasAttribute("data-video-toggle-hide-class")?t.getAttribute("data-video-toggle-hide-class"):this.options.hideClass,this.options.toggleContent=t.hasAttribute("data-video-toggle-toggle-content")?t.getAttribute("data-video-toggle-toggle-content"):this.options.toggleContent,Object.keys(this.trigger.dataset).forEach(o=>{this.cssClasses[o]&&(this.cssClasses[o]=this.trigger.dataset[o])}),this.videoContent=document.createElement("div"),this.videoContent.classList.add(...this.cssClasses.videoToggleContent.split(" ")),this.videoContent.classList.add(this.options.hideClass),this.videoContent.id="videoToggleContent"+e,this.videoIFrame=document.createElement("iframe"),this.videoIFrame.classList.add(...this.cssClasses.videoToggleIframe.split(" ")),this.videoIFrame.setAttribute("title","Video embed"),this.videoIFrame.setAttribute("allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),this.videoIFrame.setAttribute("allowfullscreen",""),this.videoIFrame.setAttribute("width","100%"),this.videoIFrame.setAttribute("height","100%"),this.videoContent.appendChild(this.videoIFrame),this.options.container.appendChild(this.videoContent),this.options.container.classList.add("video-toggle__container"),this.options.showCloseButton&&(this.videoCloseButton=document.createElement("button"),this.videoCloseButton.classList.add(...this.cssClasses.videoToggleClose.split(" ")),this.videoCloseButton.classList.add(...this.cssClasses.videoToggleCloseAfter.split(" ")),this.videoCloseButton.classList.add(this.options.hideClass),this.videoCloseButton.setAttribute("aria-label","Close video"),this.videoCloseButton.setAttribute("title","Close video"),this.videoCloseButton.addEventListener("click",this.closeVideo.bind(this)),this.options.container.appendChild(this.videoCloseButton)),t.setAttribute("aria-expanded","false"),t.setAttribute("aria-controls","videoToggleContent"+e),t.addEventListener("click",this.toggleVideo.bind(this))}toggleVideo(t){this.videoOpen?this.closeVideo(t):this.openVideo(t)}clearVideoContainer(){const t=this.options.container.querySelectorAll(".video-toggle__close"),e=this.options.container.querySelectorAll(".video-toggle__content"),s=this.options.container.querySelectorAll(".video-toggle__iframe");Array.from(t).forEach(o=>{o.classList.add(this.options.hideClass)}),Array.from(e).forEach(o=>{o.classList.add(this.options.hideClass)}),Array.from(s).forEach(o=>{o.setAttribute("src","")})}openVideo(t){this.clearVideoContainer(),this.trigger.setAttribute("aria-expanded","true"),this.videoContent.classList.remove(this.options.hideClass);let e=new URL(this.options.url);if(e.searchParams.append("autoplay","1"),this.videoIFrame.setAttribute("src",e.toString()),this.options.showCloseButton&&this.videoCloseButton.classList.remove(this.options.hideClass),this.options.hideTrigger?this.trigger.classList.add(this.options.hideClass):(this.openContent=this.trigger.innerHTML,this.trigger.innerHTML=this.options.toggleContent),this.options.aspectRatio!=="auto"){const s=this.options.aspectRatio.split(":"),o=parseInt(s[0]),n=parseInt(s[1]),a=this.options.container.offsetWidth*n/o;this.options.container.style.height=a+"px"}this.videoOpen=!0,document.dispatchEvent(new CustomEvent("videotoggle.open",{detail:this.videoContent}))}closeVideo(t){this.trigger.setAttribute("aria-expanded","false"),this.videoContent.classList.add(this.options.hideClass),this.videoIFrame.setAttribute("src",""),this.options.showCloseButton&&this.videoCloseButton.classList.add(this.options.hideClass),this.options.hideTrigger?this.trigger.classList.remove(this.options.hideClass):this.trigger.innerHTML=this.openContent,this.options.aspectRatio!=="auto"&&(this.options.container.style.height=""),this.videoOpen=!1,document.dispatchEvent(new CustomEvent("videotoggle.close",{detail:this.videoContent}));const e=this.options.container.querySelector("[data-video-toggle]");e&&e.classList.remove(this.options.hideClass)}}export{l as default};
