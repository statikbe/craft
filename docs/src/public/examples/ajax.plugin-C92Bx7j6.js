import{A as n}from"./ajax-BnX9PgEQ.js";import{A as l}from"./array.prototypes-Bj-0q804.js";l.activateFrom();class h{constructor(o){this.triggerSelector="",this.formSteps=!1,this.showCloseBtn=!1,this.options={},this.triggerSelector=o}getPluginName(){return"ajax"}getTriggerSelector(){return this.triggerSelector}getOptions(){return this.options}openModalClick(o){this.modalComponent=o;const t=this.modalComponent.trigger,e=(t&&t.getAttribute("data-modal-ajax"))??this.modalComponent.options.src;this.formSteps=this.modalComponent.options.formSteps??(t&&t.hasAttribute("data-form-steps")),this.showCloseBtn=this.modalComponent.options.showCloseBtn??(t&&t.hasAttribute("data-show-close-btn")),e&&(this.modalComponent.dialog||(this.modalComponent.dialog=document.createElement("dialog"),document.body.appendChild(this.modalComponent.dialog),this.modalComponent.onDialogCreation(),this.showCloseBtn&&(this.modalComponent.addCloseButton(),this.modalComponent.modalCloseBtn.classList.add("hidden")),this.modalLoader||(this.modalLoader=document.createElement("div"),this.modalLoader.classList.add(...this.modalComponent.cssClasses.loaderStyle.split(" ")),this.modalLoader.insertAdjacentHTML("afterbegin",'<div class="loader"></div>'),this.modalComponent.dialog.insertAdjacentElement("afterbegin",this.modalLoader)),this.ajaxContainer=document.createElement("div"),this.ajaxContainer.classList.add("ajax-container"),this.modalComponent.dialog.appendChild(this.ajaxContainer)),this.openPluginModal(e))}gotoNextAction(){}gotoPrevAction(){}closeModal(){}openPluginModal(o){this.modalComponent.dialog.showModal(),n.call({url:o,method:"GET",success:t=>{this.ajaxContainer.innerHTML=t,this.modalLoader.classList.add("hidden"),this.showCloseBtn&&this.modalComponent.modalCloseBtn.classList.remove("hidden"),this.modalComponent.activateCloseButtons(),this.formSteps&&(this.initFormStep(o),this.activateInternalLinks())}})}initFormStep(o){const t=this.ajaxContainer.querySelector("form");t&&t.addEventListener("submit",e=>{if(e.preventDefault(),!t.checkValidity())return;const a=t.getAttribute("action")||o||window.location.href,i=(t.getAttribute("method")||"POST").toUpperCase();this.modalLoader.classList.remove("hidden"),this.showCloseBtn&&this.modalComponent.modalCloseBtn.classList.add("hidden"),this.ajaxContainer.innerHTML="",n.call({url:a,method:i,form:t,success:s=>{if(t.hasAttribute("data-close-modal-on-submit")){this.modalComponent.dialog.close();return}this.ajaxContainer.innerHTML=s,this.modalLoader.classList.add("hidden"),this.showCloseBtn&&this.modalComponent.modalCloseBtn.classList.remove("hidden"),this.modalComponent.activateCloseButtons(),this.initFormStep(o),this.activateInternalLinks()},error:s=>{console.error(s),this.modalLoader.classList.add("hidden")}})})}activateInternalLinks(){this.ajaxContainer.querySelectorAll("[data-modal-ajax-internal]").forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const a=t.getAttribute("data-modal-ajax-internal");this.modalLoader.classList.remove("hidden"),a&&n.call({url:a,method:"GET",success:i=>{this.ajaxContainer.innerHTML=i,this.modalLoader.classList.add("hidden"),this.modalComponent.activateCloseButtons(),this.showCloseBtn&&this.modalComponent.modalCloseBtn.classList.remove("hidden"),this.formSteps&&(this.initFormStep(a),this.activateInternalLinks())}})})})}}export{h as AjaxModalPlugin};
