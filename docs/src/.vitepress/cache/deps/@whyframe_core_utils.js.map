{
  "version": 3,
  "sources": ["../../../../node_modules/@whyframe/core/src/utils.js"],
  "sourcesContent": ["/** @type {import('../utils').createIframeRpc} */\nexport function createIframeRpc(iframe) {\n  const nameToCallbacks = new Map()\n\n  const handler = (e) => {\n    if (nameToCallbacks.has(e.data.name)) {\n      const callbacks = nameToCallbacks.get(e.data.name)\n      for (const callback of callbacks) {\n        callback.apply(e.target, e.data.payload)\n      }\n    }\n  }\n\n  if (iframe) {\n    iframe.contentWindow?.addEventListener('message', handler)\n  } else {\n    window.addEventListener('message', handler)\n  }\n\n  return {\n    send(name, payload) {\n      if (iframe) {\n        iframe.contentWindow?.postMessage({ name, payload })\n      } else {\n        window.parent.postMessage({ name, payload })\n      }\n    },\n    on(name, callback) {\n      if (!nameToCallbacks.has(name)) {\n        nameToCallbacks.set(name, [])\n      }\n      nameToCallbacks.get(name).push(callback)\n    },\n    off(name, callback) {\n      if (!callback) {\n        nameToCallbacks.delete(name)\n      } else if (nameToCallbacks.has(name)) {\n        const callbacks = nameToCallbacks.get(name)\n        const index = callbacks.indexOf(callback)\n        if (index > -1) {\n          callbacks.splice(index, 1)\n        }\n      }\n    },\n    teardown() {\n      if (iframe) {\n        iframe.contentWindow?.removeEventListener('message', handler)\n      } else {\n        window.removeEventListener('message', handler)\n      }\n    }\n  }\n}\n\n/** @type {import('../utils').getWhyframeSource} */\nexport function getWhyframeSource(iframe) {\n  return iframe.dataset.whySource\n}\n"],
  "mappings": ";AACO,SAAS,gBAAgB,QAAQ;AADxC;AAEE,QAAM,kBAAkB,oBAAI,IAAI;AAEhC,QAAM,UAAU,CAAC,MAAM;AACrB,QAAI,gBAAgB,IAAI,EAAE,KAAK,IAAI,GAAG;AACpC,YAAM,YAAY,gBAAgB,IAAI,EAAE,KAAK,IAAI;AACjD,iBAAW,YAAY,WAAW;AAChC,iBAAS,MAAM,EAAE,QAAQ,EAAE,KAAK,OAAO;AAAA,MACzC;AAAA,IACF;AAAA,EACF;AAEA,MAAI,QAAQ;AACV,iBAAO,kBAAP,mBAAsB,iBAAiB,WAAW;AAAA,EACpD,OAAO;AACL,WAAO,iBAAiB,WAAW,OAAO;AAAA,EAC5C;AAEA,SAAO;AAAA,IACL,KAAK,MAAM,SAAS;AApBxB,UAAAA;AAqBM,UAAI,QAAQ;AACV,SAAAA,MAAA,OAAO,kBAAP,gBAAAA,IAAsB,YAAY,EAAE,MAAM,QAAQ;AAAA,MACpD,OAAO;AACL,eAAO,OAAO,YAAY,EAAE,MAAM,QAAQ,CAAC;AAAA,MAC7C;AAAA,IACF;AAAA,IACA,GAAG,MAAM,UAAU;AACjB,UAAI,CAAC,gBAAgB,IAAI,IAAI,GAAG;AAC9B,wBAAgB,IAAI,MAAM,CAAC,CAAC;AAAA,MAC9B;AACA,sBAAgB,IAAI,IAAI,EAAE,KAAK,QAAQ;AAAA,IACzC;AAAA,IACA,IAAI,MAAM,UAAU;AAClB,UAAI,CAAC,UAAU;AACb,wBAAgB,OAAO,IAAI;AAAA,MAC7B,WAAW,gBAAgB,IAAI,IAAI,GAAG;AACpC,cAAM,YAAY,gBAAgB,IAAI,IAAI;AAC1C,cAAM,QAAQ,UAAU,QAAQ,QAAQ;AACxC,YAAI,QAAQ,IAAI;AACd,oBAAU,OAAO,OAAO,CAAC;AAAA,QAC3B;AAAA,MACF;AAAA,IACF;AAAA,IACA,WAAW;AA5Cf,UAAAA;AA6CM,UAAI,QAAQ;AACV,SAAAA,MAAA,OAAO,kBAAP,gBAAAA,IAAsB,oBAAoB,WAAW;AAAA,MACvD,OAAO;AACL,eAAO,oBAAoB,WAAW,OAAO;AAAA,MAC/C;AAAA,IACF;AAAA,EACF;AACF;AAGO,SAAS,kBAAkB,QAAQ;AACxC,SAAO,OAAO,QAAQ;AACxB;",
  "names": ["_a"]
}
